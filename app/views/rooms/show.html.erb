<% provide :page_title, @room.title %>
<% provide :current_page, 'Комнаты' %>


<%= turbo_frame_tag "frame_edit" do %>
<h1 class="display-5"><%= link_to "#{@room.title}", edit_room_path(@room), style: "color:black;text-decoration:none;"%></h1>
<p class="lead"><%= link_to "#{@room.description}", edit_room_path(@room), style: "color:black;text-decoration:none;"%></p>
<% end %>



<button type="button" class="btn btn-outline-primary" type="button" data-bs-toggle="modal" data-bs-target="#Modal">Участники</button>
<button type="button" class="btn btn-outline-danger" type="button" data-bs-toggle="modal" data-bs-target="#Modal1"><%= delete_or_exit(@room.owner_id) %></button>


<div style="margin-top: 20px;">
<%= render 'shared/tasks'%>
<%= render 'shared/taskform' %>
</div>



<!-- Modal -->
<div class="modal fade" id="Modal" tabindex="-1" aria-labelledby="ModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="ModalLabel">Добавить нового пользователя в комнату</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
      <h4>Участники:</h4>
      <% @users.each do |users| %>
      <p><%= users.login %></p>
      <% end %>
      <% if current_user.id == @room.owner_id %>
      <%= form_with url: "/rooms/#{@room.id}/add", method: :post do |form| %>
        <div class="row g-3 align-items-center">
          <div class="col-auto">
          <input type="text" id="title" class="form-control" name="login" placeholder="Логин пользователя">
          </div>
          </div>
          <div style="margin-top: 7px;">
          <button type="submit" name="add" class="btn btn-primary" value="1">Добавить</button>
          <button type="submit" name="remove" class="btn btn-primary" value="2">Удалить</button>
          </div>
        <% end %>
        <% end %>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Закрыть</button>
      </div>
    </div>
  </div>
</div>


<div class="modal fade" id="Modal1" tabindex="-1" aria-labelledby="ModalLabel1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="ModalLabel1">Вы уверены?</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
                  <%= form_with url: "/rooms/#{@room.id}/delete", method: :delete do |form| %>
                  <button type="submit" class="btn btn-danger"><%= delete_or_exit(@room.owner_id) %></button>
                  <% end %>
      </div>
    </div>
  </div>
</div>

